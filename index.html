<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Announcements & Quick Start — Casual MITEC</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
  :root{
    --mitec-gold:#D4AF37;
    --mitec-mid:#224289;
    --bg:#f7f9fc;
    --card:#ffffff;
    --muted:#55606a;
    --radius:12px;
    --accent:#0b78ff;
    --carousel-interval:6000; /* ms */
    --step-duration:900;      /* ms (fast) */
    --spin-speed: 0.9s;       /* shiny ring spin */
  }

  *{box-sizing:border-box}
  body{
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background:var(--bg);
    margin:0;
    color:#101827;
    padding:28px;
  }

  .wrap{max-width:1080px;margin:0 auto;display:grid;grid-template-columns:1fr;gap:18px}
  @media(min-width:980px){ .wrap{grid-template-columns:1fr 420px} }

  .card{background:var(--card);border-radius:var(--radius);padding:18px;box-shadow:0 10px 30px rgba(12,18,30,0.06)}

  /* ---------- ANNOUNCEMENTS CAROUSEL ---------- */
  .ann-outer{position:relative}
  .ann-title{display:flex;align-items:center;gap:10px;color:var(--mitec-mid);font-weight:700;margin-bottom:12px;font-size:1.05rem}
  .ann-title i{transform-origin:center; animation:icon-bob 4s ease-in-out infinite}
  @keyframes icon-bob{0%{transform:translateY(0)}50%{transform:translateY(-4px)}100%{transform:translateY(0)}}

  .carousel {
    position:relative;
    overflow:hidden;
    border-radius:10px;
    background:linear-gradient(180deg,#fbfbfe,#fcfdff);
    padding:12px;
  }

  .slides{position:relative;}
  .slide{
    display:none;
    gap:12px;
    align-items:flex-start;
    padding:12px;
  }
  .slide.active{ display:flex; }

  .slide pre {
    margin: 0;
    white-space: pre-wrap; 
    word-wrap: break-word;
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    font-size: 0.95rem;
    color: #0f172a;
    line-height: 1.4;
  }

  .controls{display:flex;gap:8px;align-items:center;margin-top:12px;justify-content:space-between}
  .dots{display:flex;gap:8px;align-items:center}
  .dot{width:10px;height:10px;border-radius:50%;background:#e6eefb;cursor:pointer;border:1px solid #dbeafc}
  .dot[aria-current="true"]{background:var(--mitec-mid);box-shadow:0 6px 16px rgba(34,66,137,0.12)}
  .nav-btn{background:transparent;border:1px solid #e6eefb;padding:8px;border-radius:8px;cursor:pointer}

  /* ---------- QUICK-STEP with shiny circling borders ---------- */
  .quick-start .title{font-size:1.15rem;font-weight:800;margin-bottom:14px;display:flex;align-items:center;gap:8px;color:var(--mitec-mid)}
  .steps{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
  @media(max-width:540px){ .steps{grid-template-columns:1fr} }

  a.step {
    text-decoration:none;
    color:inherit;
    position:relative;
    border-radius:12px;
    padding:14px 14px 14px 12px;
    display:flex;
    gap:12px;
    align-items:center;
    background:linear-gradient(180deg,#fff,#fcfdff);
    border:1px solid #eef5ff;
    cursor:pointer;
    transition:transform 180ms ease, box-shadow 180ms ease;
    outline:none;
  }
  a.step:focus{box-shadow:0 8px 30px rgba(11,120,255,0.12);transform:translateY(-3px)}
  a.step:hover{transform:translateY(-6px);box-shadow:0 18px 40px rgba(9,14,30,0.06)}
  a.step.paused{opacity:0.94;transform:none;box-shadow:none}

  .step .content{flex:1}
  .step .title{font-weight:800;margin:0;color:#0b1330}
  .step .sub{margin:6px 0 0;color:var(--muted);font-size:0.92rem}

  .circle-wrap { width:62px; height:62px; flex:0 0 62px; position:relative; display:grid;place-items:center }
  .circle-wrap::before{
    content:"";
    position:absolute;
    inset:-4px;
    border-radius:999px;
    padding:4px;
    z-index:0;
    background: conic-gradient(from 0deg, rgba(212,175,55,0.12), rgba(212,175,55,0.22), rgba(11,120,255,0.18), rgba(34,66,137,0.22), rgba(212,175,55,0.12));
    filter: drop-shadow(0 6px 20px rgba(11,120,255,0.06));
    transform: rotate(0deg);
    animation: spinShine var(--spin-speed) linear infinite;
  }
  @keyframes spinShine{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}

  .circle-wrap svg { width:62px;height:62px; position:relative; z-index:1; transform:rotate(-90deg); }
  .circle-bg { stroke: #eef5ff; stroke-width:6; fill:none; }
  .progress { stroke: var(--mitec-mid); stroke-width:6; fill:none; stroke-linecap:round; stroke-dasharray: 314; stroke-dashoffset: 314; transition: stroke-dashoffset var(--step-duration) linear; }

  .cnum{position:absolute;font-weight:900;color:var(--mitec-mid);font-size:0.95rem;z-index:2;pointer-events:none}

  a.step.paused .circle-wrap::before{animation-play-state:paused; filter: drop-shadow(0 4px 10px rgba(11,120,255,0.04));}
  a.step.paused .progress{transition:none}

  @media (prefers-reduced-motion: reduce){
    .slide{transition:none}
    .ann-title i{animation:none}
    .circle-wrap::before{animation:none}
    .progress{transition:none; stroke-dashoffset:0}
  }

  footer{grid-column:1/-1;text-align:center;color:var(--muted);margin-top:8px;font-size:0.9rem}
</style>
</head>
<body>

<div class="wrap">
  <!-- ANNOUNCEMENTS CAROUSEL -->
  <div class="card ann-outer" aria-labelledby="ann">
    <div class="ann-title">
      <i class="fa-solid fa-bullhorn" style="color:var(--mitec-mid)"></i>
      Announcements & Updates
    </div>

    <div class="carousel" id="carousel" aria-roledescription="carousel">
      <div class="slides" id="slides">
        <!-- skeleton slides while loading -->
        <div class="slide skeleton" role="group"></div>
        <div class="slide skeleton" role="group"></div>
        <div class="slide skeleton" role="group"></div>
      </div>

      <div class="controls">
        <div>
          <button class="nav-btn" id="prevBtn" aria-label="Previous announcement"><i class="fa-solid fa-chevron-left"></i></button>
          <button class="nav-btn" id="nextBtn" aria-label="Next announcement"><i class="fa-solid fa-chevron-right"></i></button>
        </div>
        <div class="dots" id="dots" role="tablist" aria-label="Announcement pages"></div>
      </div>
    </div>
  </div>

  <!-- QUICK START with shiny circling border sequence -->
  <div class="card quick-start" aria-labelledby="qs">
    <div class="title"><i class="fa-solid fa-flag" style="color:var(--mitec-gold)"></i> Get Your Payment — 4 quick steps</div>

    <div class="steps" id="steps">
      <a class="step" href="http://www.casualmitec.online/first-time-application" target="_blank" rel="noopener">
        <div class="circle-wrap">
          <svg viewBox="0 0 100 100" aria-hidden="true">
            <circle class="circle-bg" cx="50" cy="50" r="49"></circle>
            <circle class="progress" cx="50" cy="50" r="50"></circle>
          </svg>
          <div class="cnum">1</div>
        </div>
        <div class="content">
          <div class="title">Register</div>
          <div class="sub">Submit your bank details</div>
        </div>
      </a>
      <a class="step" href="http://www.casualmitec.online/sign-in-sign-out" target="_blank" rel="noopener">
        <div class="circle-wrap">
          <svg viewBox="0 0 100 100" aria-hidden="true">
            <circle class="circle-bg" cx="50" cy="50" r="49"></circle>
            <circle class="progress" cx="50" cy="50" r="50"></circle>
          </svg>
          <div class="cnum">2</div>
        </div>
        <div class="content">
          <div class="title">Sign In / Out</div>
          <div class="sub">Clock in and out for every shift</div>
        </div>
      </a>
      <a class="step" href="http://eus-cdn.sway.static.microsoft/s/RZPlGrjCXdD5QeF2/images/NCPljCf2-Hl4r0" target="_blank" rel="noopener">
        <div class="circle-wrap">
          <svg viewBox="0 0 100 100" aria-hidden="true">
            <circle class="circle-bg" cx="50" cy="50" r="49"></circle>
            <circle class="progress" cx="50" cy="50" r="50"></circle>
          </svg>
          <div class="cnum">3</div>
        </div>
        <div class="content">
          <div class="title">Submit Voucher</div>
          <div class="sub">Hand voucher to guard for payment</div>
        </div>
      </a>
      <a class="step" href="http://www.casualmitec.online/my-record" target="_blank" rel="noopener">
        <div class="circle-wrap">
          <svg viewBox="0 0 100 100" aria-hidden="true">
            <circle class="circle-bg" cx="50" cy="50" r="49"></circle>
            <circle class="progress" cx="50" cy="50" r="50"></circle>
          </svg>
          <div class="cnum">4</div>
        </div>
        <div class="content">
          <div class="title">Check Record</div>
          <div class="sub">Verify clocking & payments</div>
        </div>
      </a>
    </div>

    <div style="margin-top:14px;color:var(--muted);font-size:0.92rem">
      Tip: keep your bank details current — payments follow the registered account.
    </div>
  </div>

  <footer>© Malaysia International Trade & Exhibition Centre — CasualMITEC</footer>
</div>

<script>
(async function(){
  const sheetId = "1Gks45PK53pcPJXePjYlRLpAhAmGPMPB3X0ec5XaLgRI";
  const slidesEl = document.getElementById('slides');
  const dotsEl = document.getElementById('dots');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const carouselInterval = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--carousel-interval')) || 6000;
  let items = [], current = 0, timer = null;

  function escapeHtml(str=''){ return String(str).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

  async function fetchSheetRows(){
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent('Sheet1')}`;
    try{
      const res = await fetch(url);
      const txt = await res.text();
      const json = JSON.parse(txt.substr(47).slice(0,-2));
      return json.table.rows || [];
    }catch(e){console.error('sheet fetch err',e); return [];}
  }

  function buildSlides(rows){
    items = rows.map(r => {
      const text = r.c && r.c[0] ? String(r.c[0].v) : '';
      return { text };
    });

    slidesEl.innerHTML = '';
    dotsEl.innerHTML = '';

    if(!items.length){
      slidesEl.innerHTML = '<div class="slide active"><div style="padding:18px;color:var(--muted)">No announcements.</div></div>';
      return;
    }

    items.forEach((it, idx) => {
      const s = document.createElement('div');
      s.className = 'slide';
      if(idx===0) s.classList.add('active');
      s.innerHTML = `<pre>${escapeHtml(it.text)}</pre>`;
      slidesEl.appendChild(s);

      const dot = document.createElement('button');
      dot.className = 'dot';
      dot.type = 'button';
      dot.setAttribute('aria-label','Go to announcement '+(idx+1));
      dot.setAttribute('aria-current', idx===0?'true':'false');
      dot.addEventListener('click', ()=> goTo(idx));
      dotsEl.appendChild(dot);
    });
  }

  function setActive(index){
    const slideEls = slidesEl.querySelectorAll('.slide');
    const dotEls = dotsEl.querySelectorAll('.dot');
    slideEls.forEach((s,i)=> s.classList.toggle('active', i===index));
    dotEls.forEach((d,i)=> d.setAttribute('aria-current', i===index?'true':'false'));
    current = index;
  }

  function goTo(index){
    setActive((index+items.length)%items.length);
    restartTimer();
  }

  function next(){ goTo(current+1); }
  function prev(){ goTo(current-1); }

  function startTimer(){ timer = setInterval(next, carouselInterval); }
  function restartTimer(){ clearInterval(timer); startTimer(); }

  prevBtn.addEventListener('click', prev);
  nextBtn.addEventListener('click', next);

  const rows = await fetchSheetRows();
  buildSlides(rows);
  if(items.length) startTimer();

})();
</script>

</body>
</html>
