<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Announcements & Quick Start — Casual MITEC</title>

<!-- FontAwesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
  :root {
    --mitec-gold: #D4AF37;
    --mitec-mid: #224289;
    --bg: #f7f9fc;
    --card: #ffffff;
    --muted: #55606a;
    --radius: 12px;
  }

  body {
    font-family: 'Inter', Arial, sans-serif;
    background: var(--bg);
    margin: 0;
    padding: 20px;
  }

  /* Card styling */
  .card {
    background: var(--card);
    border-radius: var(--radius);
    padding: 20px;
    box-shadow: 0 6px 24px rgba(0,0,0,0.06);
    max-width: 700px;
    margin: 20px auto;
  }

  /* Announcements */
  .ann-title {
    display: flex;
    align-items: center;
    gap: 10px;
    color: var(--mitec-mid);
    font-weight: 700;
    margin-bottom: 12px;
  }

  .ann-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .ann-item {
    display: flex;
    gap: 12px;
    align-items: flex-start;
    border-left: 4px solid var(--mitec-mid);
    background: #FBFBFE;
    padding: 12px 14px;
    border-radius: var(--radius);
    box-shadow: 0 2px 8px rgba(10,20,30,0.03);
  }

  .ann-item h4 {
    margin: 0;
    font-size: 0.98rem;
    color: var(--muted);
    font-weight: 600;
  }

  .ann-item p {
    margin: 6px 0 0;
    color: var(--muted);
    font-size: 0.95rem;
  }

  /* Quick Start Card */
  .card.quick-start .title {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 18px;
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--mitec-mid);
  }

  .steps {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .step-link {
    text-decoration: none;
    color: inherit;
    display: flex;
    align-items: center;
    gap: 12px;
    transition: transform .12s ease, box-shadow .12s ease;
    cursor: pointer;
    border: 1px solid #e9eef6;
    border-radius: var(--radius);
    background: var(--card);
    padding: 12px;
  }

  .step-link .num {
    flex: 0 0 44px;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: #f3f5f9;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
  }

  .step-link:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 20px rgba(20,30,50,0.08);
  }

  .step p {
    margin: 0;
    font-size: 1rem;
    font-weight: 600;
    color: #1c1f24;
  }

  footer {
    text-align: center;
    color: var(--muted);
    margin: 18px 0 60px;
    font-size: 0.9rem;
  }
</style>
</head>
<body>

<!-- Announcements -->
<div class="card announcements" aria-labelledby="ann">
  <div class="ann-title"><i class="fa-solid fa-bullhorn" style="color:var(--mitec-mid)"></i> Announcements & Updates</div>
  <div class="ann-list" id="ann-list">
    <div style="color:var(--muted)">Loading announcements…</div>
  </div>
</div>

<!-- Quick Start -->
<div class="card quick-start" aria-labelledby="qs">
  <div class="title">
    <i class="fa-solid fa-flag" style="color:var(--mitec-gold)"></i>
    Get Your Payment — 4 quick steps
  </div>

  <div class="steps" role="list">
    <a class="step step-link" role="listitem" href="https://www.casualmitec.online/first-time-application" target="_blank">
      <div class="num">1</div>
      <p>Register : Submit your Bank Details</p>
    </a>
    <a class="step step-link" role="listitem" href="https://www.casualmitec.online/sign-in-sign-out" target="_blank">
      <div class="num">2</div>
      <p>Performing SIGN IN / SIGN OUT every time you come to work</p>
    </a>
    <button class="step step-link" role="listitem" onclick="window.open('https://eus-cdn.sway.static.microsoft/s/RZPlGrjCXdD5QeF2/images/NCPljCf2-Hl4r0?quality=479&allowAnimation=true&embeddedHost=true&filterEffectsFormula=Grayscale=0,Contrast=1.15', '_blank')">
      <div class="num">3</div>
      <p>Submit Your Voucher to Guard House for Payment Processing</p>
    </button>
    <a class="step step-link" role="listitem" href="https://www.casualmitec.online/my-record" target="_blank">
      <div class="num">4</div>
      <p>Check your Clocking and Payment Record</p>
    </a>
  </div>
</div>

<footer>© Malaysia International Trade & Exhibition Centre — CasualMITEC</footer>

<script>
  const announcementsSheetID = "1Gks45PK53pcPJXePjYlRLpAhAmGPMPB3X0ec5XaLgRI";

  async function fetchSheetRows(sheetId, sheetName = 'Sheet1') {
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;
    const r = await fetch(url);
    const text = await r.text();
    const json = JSON.parse(text.substr(47).slice(0, -2));
    return json.table.rows || [];
  }

  function escapeHtml(str=''){
    return String(str).replace(/[&<>"']/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]; });
  }

  async function loadAnnouncements() {
    const box = document.getElementById('ann-list');
    try {
      const rows = await fetchSheetRows(announcementsSheetID);
      box.innerHTML = '';
      if(!rows.length){ 
        box.innerHTML = '<div style="color:var(--muted)">No announcements at the moment.</div>'; 
        return; 
      }
      rows.forEach(r => {
        const text = r.c && r.c[0] ? r.c[0].v : '';
        const item = document.createElement('div');
        item.className = 'ann-item';
        item.innerHTML = `<h4>${escapeHtml(text)}</h4>`;
        box.appendChild(item);
      });
    } catch(e) {
      console.error('Announcements load error', e);
      box.innerHTML = '<div style="color:#a33">Unable to load announcements.</div>';
    }
  }

  loadAnnouncements();
</script>

</body>
</html>